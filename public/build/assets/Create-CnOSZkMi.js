import{h as C,c as i,d as h,u as o,j as $,e as _,b as t,m as P,f as w,w as l,o as n,F as c,z as b,t as m,q as x,k as p,p as g,l as T,a as v}from"./app-ChEvl3T1.js";import{_ as j}from"./AuthenticatedLayout-CbdNuNV0.js";const M={class:"py-12"},F={class:"w-full mx-auto sm:px-6 lg:px-8"},D={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},B={class:"p-6 text-gray-900 dark:text-gray-100"},Q={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},E=["value"],L={key:0,class:"text-red-500 text-xs mt-1"},O={key:0,class:"text-red-500 text-xs mt-1"},R={class:"mb-8"},z={class:"overflow-x-auto"},G={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 border"},H={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200"},J={class:"px-4 py-2"},K=["onUpdate:modelValue","onChange"],W=["value"],X={key:0,class:"text-red-500 text-xs mt-1"},Y={class:"px-4 py-2"},Z=["onUpdate:modelValue","onInput"],tt={key:0,class:"text-red-500 text-xs mt-1"},et={class:"px-4 py-2"},st=["onUpdate:modelValue","onInput"],rt={key:0,class:"text-red-500 text-xs mt-1"},ot={class:"px-4 py-2"},dt=["onUpdate:modelValue"],at={class:"px-4 py-2 text-center"},it=["onClick"],nt={key:0,class:"text-red-500 text-xs mt-1"},lt={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"},ut={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg space-y-3"},mt={class:"flex justify-between items-center"},gt={class:"font-bold text-gray-900 dark:text-white"},pt={class:"flex justify-between items-center"},ct={class:"font-bold text-gray-900 dark:text-white"},yt={class:"flex justify-between items-center"},bt={class:"flex justify-between items-center"},xt={class:"flex space-x-2 w-48"},ft={class:"border-t pt-3 flex justify-between items-center"},kt={class:"text-lg font-bold text-indigo-600"},ht={class:"mb-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},_t={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},wt=["value"],vt={class:"flex justify-end space-x-3"},Vt=["disabled"],qt={__name:"Create",props:{suppliers:Array,items:Array,paymentMethods:Array},setup(U){const y=U,s=C({supplier_id:"",purchase_date:new Date().toISOString().substr(0,10),reference_no:"",items:[],discount_type:"fixed",discount:0,other_charges:0,notes:"",paid_amount:0,payment_method:"cash",payment_note:""}),V=()=>{s.items.push({item_id:"",quantity:1,unit_price:0,discount:0,tax:0,total:0})};V();const N=d=>{s.items.splice(d,1)},q=d=>{const e=s.items[d].item_id,r=y.items.find(u=>u.id===e);r&&(s.items[d].unit_price=r.cost||0),f(d)},f=d=>{const e=s.items[d],r=(e.quantity||0)*(e.unit_price||0);s.items[d].total=r},k=v(()=>s.items.reduce((d,e)=>d+(Number(e.total)||0),0)),I=v(()=>s.items.reduce((d,e)=>d+(Number(e.quantity)||0),0)),A=v(()=>{let d=0;return s.discount_type==="fixed"?d=Number(s.discount)||0:d=k.value*(Number(s.discount)||0)/100,k.value+(Number(s.other_charges)||0)-d}),S=()=>{s.post(route("purchases.store"),{onError:d=>{console.error(d),alert("Please check the form for errors.")}})};return(d,e)=>(n(),i(c,null,[h(o($),{title:"Add Purchase"}),h(j,null,{header:_(()=>[...e[10]||(e[10]=[t("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Add Purchase",-1)])]),default:_(()=>[t("div",M,[t("div",F,[t("div",D,[t("div",B,[t("form",{onSubmit:P(S,["prevent"])},[t("div",Q,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("Supplier Name "),t("span",{class:"text-red-500"},"*")],-1)),l(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>o(s).supplier_id=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:""},[e[11]||(e[11]=t("option",{value:""},"Select Supplier",-1)),(n(!0),i(c,null,b(y.suppliers,r=>(n(),i("option",{key:r.id,value:r.id},m(r.name),9,E))),128))],512),[[x,o(s).supplier_id]]),o(s).errors.supplier_id?(n(),i("div",L,m(o(s).errors.supplier_id),1)):p("",!0)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("Purchase Date "),t("span",{class:"text-red-500"},"*")],-1)),l(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o(s).purchase_date=r),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:""},null,512),[[g,o(s).purchase_date]]),o(s).errors.purchase_date?(n(),i("div",O,m(o(s).errors.purchase_date),1)):p("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Reference No",-1)),l(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o(s).reference_no=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,o(s).reference_no]])])]),t("div",R,[t("div",z,[t("table",G,[e[17]||(e[17]=t("thead",{class:"bg-blue-600 text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-sm font-medium"},"Item Name"),t("th",{class:"px-4 py-2 text-left text-sm font-medium w-24"},"Quantity"),t("th",{class:"px-4 py-2 text-left text-sm font-medium w-32"},"Purchase Price"),t("th",{class:"px-4 py-2 text-left text-sm font-medium w-32"},"Total Amount"),t("th",{class:"px-4 py-2 text-center text-sm font-medium w-16"},"Action")])],-1)),t("tbody",H,[(n(!0),i(c,null,b(o(s).items,(r,u)=>(n(),i("tr",{key:u},[t("td",J,[l(t("select",{"onUpdate:modelValue":a=>r.item_id=a,onChange:a=>q(u),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",required:""},[e[15]||(e[15]=t("option",{value:""},"Select Item",-1)),(n(!0),i(c,null,b(y.items,a=>(n(),i("option",{key:a.id,value:a.id},m(a.name)+" ("+m(a.code)+")",9,W))),128))],40,K),[[x,r.item_id]]),o(s).errors[`items.${u}.item_id`]?(n(),i("div",X,m(o(s).errors[`items.${u}.item_id`]),1)):p("",!0)]),t("td",Y,[l(t("input",{"onUpdate:modelValue":a=>r.quantity=a,onInput:a=>f(u),type:"number",step:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm text-right",required:""},null,40,Z),[[g,r.quantity]]),o(s).errors[`items.${u}.quantity`]?(n(),i("div",tt,m(o(s).errors[`items.${u}.quantity`]),1)):p("",!0)]),t("td",et,[l(t("input",{"onUpdate:modelValue":a=>r.unit_price=a,onInput:a=>f(u),type:"number",step:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm text-right",required:""},null,40,st),[[g,r.unit_price]]),o(s).errors[`items.${u}.unit_price`]?(n(),i("div",rt,m(o(s).errors[`items.${u}.unit_price`]),1)):p("",!0)]),t("td",ot,[l(t("input",{"onUpdate:modelValue":a=>r.total=a,type:"number",step:"0.01",class:"block w-full rounded-md border-gray-300 bg-gray-100 dark:bg-gray-600 shadow-sm dark:text-white text-sm text-right cursor-not-allowed",disabled:""},null,8,dt),[[g,r.total]])]),t("td",at,[t("button",{type:"button",onClick:a=>N(u),class:"text-red-600 hover:text-red-900"},[...e[16]||(e[16]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,it)])]))),128))]),t("tfoot",null,[t("tr",null,[t("td",{colspan:"5",class:"px-4 py-2"},[t("button",{type:"button",onClick:V,class:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm w-full block"}," + Add Another Item ")])])])])]),o(s).errors.items?(n(),i("div",nt,m(o(s).errors.items),1)):p("",!0)]),t("div",lt,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Note",-1)),l(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=r=>o(s).notes=r),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,o(s).notes]])]),t("div",ut,[t("div",mt,[e[19]||(e[19]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Quantities:",-1)),t("span",gt,m(I.value),1)]),t("div",pt,[e[20]||(e[20]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Subtotal:",-1)),t("span",ct,m(k.value.toFixed(2)),1)]),t("div",yt,[e[21]||(e[21]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Other Charges:",-1)),l(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>o(s).other_charges=r),type:"number",step:"0.01",class:"w-32 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-right text-sm"},null,512),[[g,o(s).other_charges]])]),t("div",bt,[e[23]||(e[23]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Discount on All:",-1)),t("div",xt,[l(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>o(s).discount=r),type:"number",step:"0.01",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-right text-sm"},null,512),[[g,o(s).discount]]),l(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>o(s).discount_type=r),class:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"},[...e[22]||(e[22]=[t("option",{value:"fixed"},"Fixed",-1),t("option",{value:"percentage"},"%",-1)])],512),[[x,o(s).discount_type]])])]),t("div",ft,[e[24]||(e[24]=t("span",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Grand Total:",-1)),t("span",kt,m(A.value.toFixed(2)),1)])])]),t("div",ht,[e[28]||(e[28]=t("h3",{class:"text-lg font-medium text-indigo-700 dark:text-indigo-400 mb-4"},"Make Payment",-1)),t("div",_t,[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Amount",-1)),l(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>o(s).paid_amount=r),type:"number",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,o(s).paid_amount]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Payment Type",-1)),l(t("select",{"onUpdate:modelValue":e[8]||(e[8]=r=>o(s).payment_method=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[(n(!0),i(c,null,b(y.paymentMethods,r=>(n(),i("option",{key:r,value:r},m(r),9,wt))),128))],512),[[x,o(s).payment_method]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Payment Note",-1)),l(t("input",{"onUpdate:modelValue":e[9]||(e[9]=r=>o(s).payment_note=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,o(s).payment_note]])])])]),t("div",vt,[h(o(T),{href:d.route("purchases.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:_(()=>[...e[29]||(e[29]=[w(" Close ",-1)])]),_:1},8,["href"]),t("button",{type:"submit",class:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded shadow-lg",disabled:o(s).processing}," Save Purchase ",8,Vt)])],32)])])])])]),_:1})],64))}};export{qt as default};
