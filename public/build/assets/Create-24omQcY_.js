import{u as I,c as n,b as h,d as r,h as $,w as _,e as t,z as P,j as w,g as l,f as i,F as c,l as b,t as m,A as x,i as p,k as g,s as T,q as v}from"./app-CV5OePXJ.js";import{_ as j}from"./AuthenticatedLayout-73GYwnhN.js";import{S as B}from"./sweetalert2.esm.all-BoFtKDfH.js";const M={class:"py-12"},F={class:"w-full mx-auto sm:px-6 lg:px-8"},D={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},Q={class:"p-6 text-gray-900 dark:text-gray-100"},E={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg"},L=["value"],O={key:0,class:"text-red-500 text-xs mt-1"},R={key:0,class:"text-red-500 text-xs mt-1"},Y={class:"mb-8"},z={class:"overflow-x-auto"},G={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700 border"},H={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200"},J={class:"px-4 py-2"},K=["onUpdate:modelValue","onChange"],W=["value"],X={key:0,class:"text-red-500 text-xs mt-1"},Z={class:"px-4 py-2"},tt=["onUpdate:modelValue","onInput"],et={key:0,class:"text-red-500 text-xs mt-1"},st={class:"px-4 py-2"},ot=["onUpdate:modelValue","onInput"],rt={key:0,class:"text-red-500 text-xs mt-1"},dt={class:"px-4 py-2"},at=["onUpdate:modelValue"],nt={class:"px-4 py-2 text-center"},it=["onClick"],lt={key:0,class:"text-red-500 text-xs mt-1"},ut={class:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"},mt={class:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg space-y-3"},gt={class:"flex justify-between items-center"},pt={class:"font-bold text-gray-900 dark:text-white"},ct={class:"flex justify-between items-center"},yt={class:"font-bold text-gray-900 dark:text-white"},bt={class:"flex justify-between items-center"},xt={class:"flex justify-between items-center"},ft={class:"flex space-x-2 w-48"},kt={class:"border-t pt-3 flex justify-between items-center"},ht={class:"text-lg font-bold text-indigo-600"},_t={class:"mb-8 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},wt={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},vt=["value"],Vt={class:"flex justify-end space-x-3"},Ut=["disabled"],St={__name:"Create",props:{suppliers:Array,items:Array,paymentMethods:Array},setup(U){const y=U,s=I({supplier_id:"",purchase_date:new Date().toISOString().substr(0,10),reference_no:"",items:[],discount_type:"fixed",discount:0,other_charges:0,notes:"",paid_amount:0,payment_method:"cash",payment_note:""}),V=()=>{s.items.push({item_id:"",quantity:1,unit_price:0,discount:0,tax:0,total:0})};V();const C=d=>{B.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, remove it!"}).then(e=>{e.isConfirmed&&s.items.splice(d,1)})},A=d=>{const e=s.items[d].item_id,o=y.items.find(u=>u.id===e);o&&(s.items[d].unit_price=o.cost||0),f(d)},f=d=>{const e=s.items[d],o=(e.quantity||0)*(e.unit_price||0);s.items[d].total=o},k=v(()=>s.items.reduce((d,e)=>d+(Number(e.total)||0),0)),N=v(()=>s.items.reduce((d,e)=>d+(Number(e.quantity)||0),0)),S=v(()=>{let d=0;return s.discount_type==="fixed"?d=Number(s.discount)||0:d=k.value*(Number(s.discount)||0)/100,k.value+(Number(s.other_charges)||0)-d}),q=()=>{s.post(route("purchases.store"),{onError:d=>{console.error(d),alert("Please check the form for errors.")}})};return(d,e)=>(i(),n(c,null,[h(r($),{title:"Add Purchase"}),h(j,null,{header:_(()=>[...e[10]||(e[10]=[t("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Add Purchase",-1)])]),default:_(()=>[t("div",M,[t("div",F,[t("div",D,[t("div",Q,[t("form",{onSubmit:P(q,["prevent"])},[t("div",E,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("Supplier Name "),t("span",{class:"text-red-500"},"*")],-1)),l(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>r(s).supplier_id=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:""},[e[11]||(e[11]=t("option",{value:""},"Select Supplier",-1)),(i(!0),n(c,null,b(y.suppliers,o=>(i(),n("option",{key:o.id,value:o.id},m(o.name),9,L))),128))],512),[[x,r(s).supplier_id]]),r(s).errors.supplier_id?(i(),n("div",O,m(r(s).errors.supplier_id),1)):p("",!0)]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("Purchase Date "),t("span",{class:"text-red-500"},"*")],-1)),l(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r(s).purchase_date=o),type:"date",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",required:""},null,512),[[g,r(s).purchase_date]]),r(s).errors.purchase_date?(i(),n("div",R,m(r(s).errors.purchase_date),1)):p("",!0)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Reference No",-1)),l(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>r(s).reference_no=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,r(s).reference_no]])])]),t("div",Y,[t("div",z,[t("table",G,[e[17]||(e[17]=t("thead",{class:"bg-blue-600 text-white"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left text-sm font-medium"},"Item Name"),t("th",{class:"px-4 py-2 text-left text-sm font-medium w-24"},"Quantity"),t("th",{class:"px-4 py-2 text-left text-sm font-medium w-32"},"Purchase Price"),t("th",{class:"px-4 py-2 text-left text-sm font-medium w-32"},"Total Amount"),t("th",{class:"px-4 py-2 text-center text-sm font-medium w-16"},"Action")])],-1)),t("tbody",H,[(i(!0),n(c,null,b(r(s).items,(o,u)=>(i(),n("tr",{key:u},[t("td",J,[l(t("select",{"onUpdate:modelValue":a=>o.item_id=a,onChange:a=>A(u),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm",required:""},[e[15]||(e[15]=t("option",{value:""},"Select Item",-1)),(i(!0),n(c,null,b(y.items,a=>(i(),n("option",{key:a.id,value:a.id},m(a.name)+" ("+m(a.code)+")",9,W))),128))],40,K),[[x,o.item_id]]),r(s).errors[`items.${u}.item_id`]?(i(),n("div",X,m(r(s).errors[`items.${u}.item_id`]),1)):p("",!0)]),t("td",Z,[l(t("input",{"onUpdate:modelValue":a=>o.quantity=a,onInput:a=>f(u),type:"number",step:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm text-right",required:""},null,40,tt),[[g,o.quantity]]),r(s).errors[`items.${u}.quantity`]?(i(),n("div",et,m(r(s).errors[`items.${u}.quantity`]),1)):p("",!0)]),t("td",st,[l(t("input",{"onUpdate:modelValue":a=>o.unit_price=a,onInput:a=>f(u),type:"number",step:"0.01",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white text-sm text-right",required:""},null,40,ot),[[g,o.unit_price]]),r(s).errors[`items.${u}.unit_price`]?(i(),n("div",rt,m(r(s).errors[`items.${u}.unit_price`]),1)):p("",!0)]),t("td",dt,[l(t("input",{"onUpdate:modelValue":a=>o.total=a,type:"number",step:"0.01",class:"block w-full rounded-md border-gray-300 bg-gray-100 dark:bg-gray-600 shadow-sm dark:text-white text-sm text-right cursor-not-allowed",disabled:""},null,8,at),[[g,o.total]])]),t("td",nt,[t("button",{type:"button",onClick:a=>C(u),class:"text-red-600 hover:text-red-900"},[...e[16]||(e[16]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,it)])]))),128))]),t("tfoot",null,[t("tr",null,[t("td",{colspan:"5",class:"px-4 py-2"},[t("button",{type:"button",onClick:V,class:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm w-full block"}," + Add Another Item ")])])])])]),r(s).errors.items?(i(),n("div",lt,m(r(s).errors.items),1)):p("",!0)]),t("div",ut,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Note",-1)),l(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>r(s).notes=o),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,r(s).notes]])]),t("div",mt,[t("div",gt,[e[19]||(e[19]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Quantities:",-1)),t("span",pt,m(N.value),1)]),t("div",ct,[e[20]||(e[20]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Subtotal:",-1)),t("span",yt,m(k.value.toFixed(2)),1)]),t("div",bt,[e[21]||(e[21]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Other Charges:",-1)),l(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r(s).other_charges=o),type:"number",step:"0.01",class:"w-32 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-right text-sm"},null,512),[[g,r(s).other_charges]])]),t("div",xt,[e[23]||(e[23]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Discount on All:",-1)),t("div",ft,[l(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>r(s).discount=o),type:"number",step:"0.01",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-right text-sm"},null,512),[[g,r(s).discount]]),l(t("select",{"onUpdate:modelValue":e[6]||(e[6]=o=>r(s).discount_type=o),class:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm"},[...e[22]||(e[22]=[t("option",{value:"fixed"},"Fixed",-1),t("option",{value:"percentage"},"%",-1)])],512),[[x,r(s).discount_type]])])]),t("div",kt,[e[24]||(e[24]=t("span",{class:"text-lg font-bold text-gray-900 dark:text-white"},"Grand Total:",-1)),t("span",ht,m(S.value.toFixed(2)),1)])])]),t("div",_t,[e[28]||(e[28]=t("h3",{class:"text-lg font-medium text-indigo-700 dark:text-indigo-400 mb-4"},"Make Payment",-1)),t("div",wt,[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Amount",-1)),l(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>r(s).paid_amount=o),type:"number",step:"0.01",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,r(s).paid_amount]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Payment Type",-1)),l(t("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>r(s).payment_method=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[(i(!0),n(c,null,b(y.paymentMethods,o=>(i(),n("option",{key:o,value:o},m(o),9,vt))),128))],512),[[x,r(s).payment_method]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Payment Note",-1)),l(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>r(s).payment_note=o),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,512),[[g,r(s).payment_note]])])])]),t("div",Vt,[h(r(T),{href:d.route("purchases.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"},{default:_(()=>[...e[29]||(e[29]=[w(" Close ",-1)])]),_:1},8,["href"]),t("button",{type:"submit",class:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded shadow-lg",disabled:r(s).processing}," Save Purchase ",8,Ut)])],32)])])])])]),_:1})],64))}};export{St as default};
