import{h as T,y as C,G as $,c as l,d as m,u as r,j as M,e as y,b as t,m as D,o as i,w as u,F as f,q as k,t as p,s as U,k as g,p as c,f as q,n as N,E as P}from"./app-Bk2YWDrY.js";import{_ as E}from"./AuthenticatedLayout-DQNhU5jl.js";import{_ as b}from"./InputLabel-jOlezjJ9.js";import{_ as I}from"./TextInput-B1CEivqf.js";import{P as L}from"./PrimaryButton-BmelFIfY.js";import{S}from"./sweetalert2.esm.all-BoFtKDfH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"py-12"},G={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},R={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},O={class:"p-6 text-gray-900 dark:text-gray-100"},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},H={key:0},J=["value"],K={key:0,class:"text-red-500 text-xs mt-1"},W={key:0,class:"text-red-500 text-xs mt-1"},X={key:0,class:"text-red-500 text-xs mt-1"},Z={class:"overflow-x-auto mb-6"},tt={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},et={class:"px-2 py-2 min-w-[200px]"},ot=["onUpdate:modelValue","onChange"],st=["value"],rt={class:"px-2 py-2"},dt=["onUpdate:modelValue"],nt={class:"px-2 py-2"},at=["onUpdate:modelValue"],lt={class:"px-2 py-2"},it=["onUpdate:modelValue"],ut={class:"px-2 py-2"},mt=["onUpdate:modelValue"],pt={class:"px-2 py-2"},ct=["onUpdate:modelValue","onInput"],xt={class:"px-2 py-2"},_t=["onUpdate:modelValue","readonly","onInput"],gt={class:"px-2 py-2 text-right font-semibold"},yt={class:"px-2 py-2"},ft=["onClick"],bt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 border-t pt-4"},ht={class:"bg-gray-50 dark:bg-gray-900 p-4 rounded-md"},vt={class:"flex justify-between mb-2"},wt={class:"flex justify-between mb-2 items-center"},kt={class:"flex justify-between mb-2 items-center"},Vt={class:"flex justify-between mb-4 text-lg font-bold border-t pt-2"},Ct={class:"flex justify-between mb-2 items-center"},Ut={class:"mt-6 flex justify-end"},Tt={__name:"Create",props:{customers:Array,items:Array},setup(h){const F=h,V=P().props.auth.user,v=V.roles.some(d=>d.name==="customer"),o=T({customer_id:v&&V.customer_id||"",quotation_date:new Date().toISOString().substr(0,10),valid_until:"",items:[{item_id:"",description:"",size:"",color:"",gsm:"",print_color:"",print_side:"",quantity:1,unit_price:0,total:0}],subtotal:0,discount:0,other_charges:0,advance_amount:0,grand_total:0,notes:"",terms_conditions:""}),B=()=>{o.items.push({item_id:"",description:"",size:"",color:"",gsm:"",print_color:"",print_side:"",quantity:1,unit_price:0,total:0})},j=d=>{S.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, remove it!"}).then(e=>{e.isConfirmed&&(o.items.splice(d,1),x(),S.fire("Removed!","Item has been removed.","success"))})},z=d=>{const e=o.items[d].item_id,a=F.items.find(s=>s.id===e);a&&(o.items[d].description=a.name,o.items[d].unit_price=a.price,o.items[d].size=a.size||"",o.items[d].color=a.fabric_color||"",o.items[d].gsm=a.gsm||"",o.items[d].print_color=a.print_color_count||"",o.items[d].print_side=a.print_sides||"",w(d))},w=d=>{const e=o.items[d];e.total=(e.quantity*e.unit_price).toFixed(2),x()},x=()=>{let d=0;o.items.forEach(s=>{d+=parseFloat(s.total)||0}),o.subtotal=d.toFixed(2);const e=parseFloat(o.other_charges)||0,a=parseFloat(o.discount)||0;o.grand_total=(d+e-a).toFixed(2)};C(()=>o.items,d=>{d.forEach((e,a)=>{const s=(e.quantity*e.unit_price).toFixed(2);s!==e.total&&(e.total=s,x())}),x()},{deep:!0}),C(()=>[o.other_charges,o.discount],()=>{x()});const A=()=>{o.post(route("quotations.store"))};return(d,e)=>{const a=$("Link");return i(),l(f,null,[m(r(M),{title:"Create Quotation"}),m(E,null,{header:y(()=>[...e[7]||(e[7]=[t("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},"Create Quotation",-1)])]),default:y(()=>[t("div",Q,[t("div",G,[t("div",R,[t("div",O,[t("form",{onSubmit:D(A,["prevent"])},[t("div",Y,[r(v)?g("",!0):(i(),l("div",H,[m(b,{for:"customer_id",value:"Customer"}),u(t("select",{id:"customer_id","onUpdate:modelValue":e[0]||(e[0]=s=>r(o).customer_id=s),class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",required:""},[e[8]||(e[8]=t("option",{value:"",disabled:""},"Select Customer",-1)),(i(!0),l(f,null,k(h.customers,s=>(i(),l("option",{key:s.id,value:s.id},p(s.name)+" ("+p(s.phone)+")",9,J))),128))],512),[[U,r(o).customer_id]]),r(o).errors.customer_id?(i(),l("div",K,p(r(o).errors.customer_id),1)):g("",!0)])),t("div",null,[m(b,{for:"quotation_date",value:"Date"}),m(I,{id:"quotation_date",type:"date",class:"mt-1 block w-full",modelValue:r(o).quotation_date,"onUpdate:modelValue":e[1]||(e[1]=s=>r(o).quotation_date=s),required:""},null,8,["modelValue"]),r(o).errors.quotation_date?(i(),l("div",W,p(r(o).errors.quotation_date),1)):g("",!0)]),t("div",null,[m(b,{for:"valid_until",value:"Valid Until"}),m(I,{id:"valid_until",type:"date",class:"mt-1 block w-full",modelValue:r(o).valid_until,"onUpdate:modelValue":e[2]||(e[2]=s=>r(o).valid_until=s)},null,8,["modelValue"]),r(o).errors.valid_until?(i(),l("div",X,p(r(o).errors.valid_until),1)):g("",!0)])]),t("div",Z,[t("table",tt,[e[11]||(e[11]=t("thead",null,[t("tr",null,[t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Item"),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Size"),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Color"),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"GSM"),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase"},"Print Color"),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase text-right"},"Qty"),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase text-right"},"Rate"),t("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase text-right"},"Total"),t("th")])],-1)),t("tbody",null,[(i(!0),l(f,null,k(r(o).items,(s,_)=>(i(),l("tr",{key:_},[t("td",et,[u(t("select",{"onUpdate:modelValue":n=>s.item_id=n,onChange:n=>z(_),class:"w-full border-gray-300 dark:border-gray-700 rounded-md shadow-sm text-sm",required:""},[e[9]||(e[9]=t("option",{value:"",disabled:""},"Select Item",-1)),(i(!0),l(f,null,k(h.items,n=>(i(),l("option",{key:n.id,value:n.id},p(n.name)+" - "+p(n.code),9,st))),128))],40,ot),[[U,s.item_id]])]),t("td",rt,[u(t("input",{"onUpdate:modelValue":n=>s.size=n,type:"text",class:"w-20 border-gray-300 rounded-md text-sm p-1"},null,8,dt),[[c,s.size]])]),t("td",nt,[u(t("input",{"onUpdate:modelValue":n=>s.color=n,type:"text",class:"w-20 border-gray-300 rounded-md text-sm p-1"},null,8,at),[[c,s.color]])]),t("td",lt,[u(t("input",{"onUpdate:modelValue":n=>s.gsm=n,type:"text",class:"w-16 border-gray-300 rounded-md text-sm p-1"},null,8,it),[[c,s.gsm]])]),t("td",ut,[u(t("input",{"onUpdate:modelValue":n=>s.print_color=n,type:"text",class:"w-20 border-gray-300 rounded-md text-sm p-1"},null,8,mt),[[c,s.print_color]])]),t("td",pt,[u(t("input",{"onUpdate:modelValue":n=>s.quantity=n,type:"number",min:"1",class:"w-20 border-gray-300 rounded-md text-sm p-1 text-right",required:"",onInput:n=>w(_)},null,40,ct),[[c,s.quantity]])]),t("td",xt,[u(t("input",{"onUpdate:modelValue":n=>s.unit_price=n,type:"number",step:"0.01",min:"0",class:"w-24 border-gray-300 rounded-md text-sm p-1 text-right",readonly:r(v),onInput:n=>w(_),required:""},null,40,_t),[[c,s.unit_price]])]),t("td",gt,p(s.total),1),t("td",yt,[r(o).items.length>1?(i(),l("button",{key:0,type:"button",onClick:n=>j(_),class:"text-red-500 hover:text-red-700"},[...e[10]||(e[10]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ft)):g("",!0)])]))),128))])]),t("button",{type:"button",onClick:B,class:"mt-2 text-indigo-600 hover:text-indigo-900 text-sm font-medium flex items-center"}," + Add Another Item ")]),t("div",bt,[t("div",null,[m(b,{for:"notes",value:"Notes"}),u(t("textarea",{id:"notes","onUpdate:modelValue":e[3]||(e[3]=s=>r(o).notes=s),rows:"3",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,512),[[c,r(o).notes]])]),t("div",ht,[t("div",vt,[e[12]||(e[12]=t("span",{class:"font-medium"},"Subtotal:",-1)),t("span",null,p(r(o).subtotal),1)]),t("div",wt,[e[13]||(e[13]=t("span",{class:"text-sm"},"Other Charges:",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(o).other_charges=s),type:"number",step:"0.01",class:"w-24 border-gray-300 rounded-md text-sm p-1 text-right"},null,512),[[c,r(o).other_charges]])]),t("div",kt,[e[14]||(e[14]=t("span",{class:"text-sm"},"Discount:",-1)),u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>r(o).discount=s),type:"number",step:"0.01",class:"w-24 border-gray-300 rounded-md text-sm p-1 text-right"},null,512),[[c,r(o).discount]])]),t("div",Vt,[e[15]||(e[15]=t("span",null,"Grand Total:",-1)),t("span",null,p(r(o).grand_total),1)]),t("div",Ct,[e[16]||(e[16]=t("span",{class:"text-sm font-medium text-green-700"},"Advance Payment:",-1)),u(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>r(o).advance_amount=s),type:"number",step:"0.01",class:"w-24 border-green-300 rounded-md text-sm p-1 text-right focus:ring-green-500"},null,512),[[c,r(o).advance_amount]])])])]),t("div",Ut,[m(a,{href:d.route("quotations.index"),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md mr-2 hover:bg-gray-300"},{default:y(()=>[...e[17]||(e[17]=[q("Cancel",-1)])]),_:1},8,["href"]),m(L,{class:N({"opacity-25":r(o).processing}),disabled:r(o).processing},{default:y(()=>[...e[18]||(e[18]=[q(" Create Quotation ",-1)])]),_:1},8,["class","disabled"])])],32)])])])])]),_:1})],64)}}};export{Tt as default};
